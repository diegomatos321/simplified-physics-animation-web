import{d as E,r as x,g as D,o as _,c as G,a as t,h as V,t as f,w as N,b as z,u as A,i as L,f as R}from"./index-DHBAdLQJ.js";import{p as U,c as W,r as p,f as l,G as b,T as C,S as F,_ as I,E as y,g as J,a as K}from"./SceneThreaded-DWFxNHy2.js";const O={style:{"max-width":"1000px"},class:"mx-auto space-y-4"},q={class:"w-full flex flex-col md:flex-row gap-6"},H={class:"md:w-1/3 border border-slate-200 rounded p-4 space-y-2"},Q={class:"flex justify-between"},X={class:"flex justify-between"},Y={class:"flex justify-between"},Z={class:"flex justify-between"},$={class:"flex justify-between"},ee=4,a=600,g=40,oe=E({__name:"ClothAndTrellis",setup(te){let v=!1,i=!1;const m=x(0);let n=null,o=null;const c=x(null);let d=null;D(()=>{if(!(!c.value||v)){if(v=!0,d===null){const s=e=>{e.setup=()=>P(e),e.draw=()=>k(e)};d=new U(s)}i&&(o=W(),o.addEventListener("message",w))}});async function P(s){if(c.value!==null)if(s.createCanvas(a,a).parent(c.value),i&&o){const e=[],r={type:p.Trellis,x:130,y:200,width:100,height:100,nx:4,ny:4,reinforce:!0},u={type:p.Trellis,x:100,y:450,width:200,height:100,nx:3,ny:2,reinforce:!0},h={type:p.Trellis,x:250,y:200,width:100,height:100,nx:10,ny:10},M={type:p.Polygon,x:200,y:50,size:100,k:5};e.push(r,u,h,M);const T={type:"start",config:{worldBoundings:{top:[0,0],right:[a,a]},BroadPhase:C.GridSpatialPartition,CollisionDetection:b.GjkEpa,gravity:l(0,98,0),gridSize:g},objects:e};o.postMessage(T)}else{n=new F(new I({worldBoundings:{top:[0,0],right:[a,a]},BroadPhase:C.GridSpatialPartition,CollisionDetection:b.GjkEpa,gravity:l(0,98,0),gridSize:g}));const e=new y(l(130,200,0),l(100,100,0),4,4,!0,!0);e.particles[0].isStatic=!0,n.add(e);const r=new y(l(100,450,0),l(200,100,0),3,2,!0);n.add(r);const u=new y(l(250,200,0),l(100,100,0),10,10);u.particles[0].isStatic=!0,u.particles[10].isStatic=!0,n.add(u);const h=J.PolygonBuilder(200,50,100,5);n.add(h)}}function k(s){if(n){s.background("#ffffff"),s.push(),s.stroke("#e0e0e0"),s.strokeWeight(1);for(let e=0;e<=s.width;e+=g)s.line(e+.5,0,e+.5,s.height);for(let e=0;e<=s.height;e+=g)s.line(0,e+.5,s.width,e+.5);s.pop(),m.value=Math.round(s.frameRate()),n.step(s.deltaTime/1e3),n.render(s)}}_(()=>{console.log("Clean up"),d&&(d.remove(),d=null),o&&(o.removeEventListener("message",w),o.terminate(),o=null)});function S(){return n?n.getParticlesCount():0}function j(){return n?n.getConstraintsCount():0}function B(){return n?n.getCollisionsCount():0}function w(s){if(!n||!(n instanceof K))return;const e=s.data;e.type==="simulation_state"&&(n.simulation_state=e.state)}return(s,e)=>(R(),G("div",O,[e[9]||(e[9]=t("div",null,[t("h1",{class:"text-3xl"},[t("strong",null,"Tecido e TreliÃ§as")])],-1)),t("div",q,[t("div",{class:"md:w-2/3",ref_key:"sketchContainer",ref:c},null,512),t("div",H,[t("div",Q,[e[1]||(e[1]=t("p",null,"FPS",-1)),t("p",null,f(m.value),1)]),t("div",{class:"flex justify-between"},[e[2]||(e[2]=t("p",null,"Entities",-1)),t("p",null,f(ee))]),t("div",X,[e[3]||(e[3]=t("p",null,"Particles",-1)),t("p",null,f(S()),1)]),t("div",Y,[e[4]||(e[4]=t("p",null,"Constraints",-1)),t("p",null,f(j()),1)]),t("div",Z,[e[5]||(e[5]=t("p",null,"Collision Tests",-1)),t("p",null,f(B()),1)]),e[7]||(e[7]=t("hr",{class:"my-4 border-slate-200"},null,-1)),t("div",$,[e[6]||(e[6]=t("label",{for:"threaded"},"Threaded Mode",-1)),N(t("input",{id:"threaded",name:"threaded",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=r=>L(i)?i.value=r:i=r)},null,512),[[z,A(i)]])]),e[8]||(e[8]=V('<div class="flex justify-between"><label for="broadPhaseMode">Broad Phase</label><select style="max-width:100px;" name="broadPhaseMode" id="broadPhaseMode" class="border border-slate-200 rounded"><option value="gridSpatialPartition">Grid Spatial Partition</option><option value="naive">Naive</option></select></div><div class="flex justify-between"><label for="collisionDetectionMode">Collision Detection</label><select style="max-width:100px;" name="collisionDetectionMode" id="collisionDetectionMode" class="border border-slate-200 rounded"><option value="gjk">GJK/EPA</option><option value="sat">Sat</option></select></div>',2))])])]))}});export{oe as default};
